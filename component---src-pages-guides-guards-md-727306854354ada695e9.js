(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{151:function(e,a,n){"use strict";n.r(a),n.d(a,"_frontmatter",function(){return p});var t=n(167),s=n.n(t),c=n(0),o=n.n(c),m=n(168),l=n(169);a.default=function(e){var a=e.components,n=s()(e,["components"]);return o.a.createElement(m.MDXTag,{name:"wrapper",Layout:l.a,layoutProps:n,components:a},o.a.createElement(m.MDXTag,{name:"h1",components:a,props:{id:"guards-conditional-transitions"}},o.a.createElement(m.MDXTag,{name:"a",components:a,parentName:"h1",props:{href:"#guards-conditional-transitions","aria-hidden":!0,class:"anchor"}}),"Guards (Conditional Transitions)"),o.a.createElement(m.MDXTag,{name:"p",components:a},"Many times, you'll want a transition between states to only take place if certain conditions on the state (finite or extended) or the event are met. For instance, let's say you're creating a statechart for a search form, and you only want search to be allowed if:"),o.a.createElement(m.MDXTag,{name:"ul",components:a},o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"the user is allowed to search (",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},".canSearch")," in this example)"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"the search event ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"query")," is not empty.")),o.a.createElement(m.MDXTag,{name:"p",components:a},'This is a good use case for a "transition guard", which determines if a transition can occur given the state and the event. A ',o.a.createElement(m.MDXTag,{name:"strong",components:a,parentName:"p"},"guard")," is a function defined on the ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"cond")," property that takes 2 arguments:"),o.a.createElement(m.MDXTag,{name:"ul",components:a},o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"context")," - the ",o.a.createElement(m.MDXTag,{name:"a",components:a,parentName:"li",props:{href:"/xstate/guides/context"}},"machine context")),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"event")," - the event, represented as an object")),o.a.createElement(m.MDXTag,{name:"p",components:a},"and returns either ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"true")," or ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"false"),", which signifies whether the transition should be allowed to take place:"),o.a.createElement("div",{className:"gatsby-highlight","data-language":"js"},o.a.createElement("pre",{className:"language-js"},o.a.createElement("code",{className:"language-js"},o.a.createElement("span",{className:"token keyword"},"import")," ",o.a.createElement("span",{className:"token punctuation"},"{")," Machine ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token keyword"},"from")," ",o.a.createElement("span",{className:"token string"},"'xstate'"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token keyword"},"const")," searchMachine ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"Machine"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"{"),"\n","  ","id",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'search'"),o.a.createElement("span",{className:"token punctuation"},","),"\n","  ","initial",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'idle'"),o.a.createElement("span",{className:"token punctuation"},","),"\n","  ","context",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","    ","canSearch",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token boolean"},"true"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","  ","states",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","    ","idle",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","      ","on",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","        ",o.a.createElement("span",{className:"token constant"},"SEARCH"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","          ","target",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'searching'"),o.a.createElement("span",{className:"token punctuation"},","),"\n","          ",o.a.createElement("span",{className:"token comment"},"// only transition to 'searching' if cond is true"),"\n","          ","cond",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"("),"ctx",o.a.createElement("span",{className:"token punctuation"},",")," event",o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token operator"},"=>")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","            ",o.a.createElement("span",{className:"token keyword"},"return")," ctx",o.a.createElement("span",{className:"token punctuation"},"."),"canSearch ",o.a.createElement("span",{className:"token operator"},"&&")," event",o.a.createElement("span",{className:"token punctuation"},"."),"query ",o.a.createElement("span",{className:"token operator"},"&&")," event",o.a.createElement("span",{className:"token punctuation"},"."),"query",o.a.createElement("span",{className:"token punctuation"},"."),"length ",o.a.createElement("span",{className:"token operator"},">")," ",o.a.createElement("span",{className:"token number"},"0"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","          ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","        ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","      ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","    ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","    ","searching",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","      ","onEntry",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'executeSearch'"),"\n","      ",o.a.createElement("span",{className:"token comment"},"// ..."),"\n","    ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","    ","searchError",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","      ",o.a.createElement("span",{className:"token comment"},"// ..."),"\n","    ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";")))),o.a.createElement(m.MDXTag,{name:"p",components:a},"If the ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"cond")," guard returns ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"false"),", then the transition will not be selected, and no transition will take place from that state node."),o.a.createElement(m.MDXTag,{name:"p",components:a},"Example of usage with context:"),o.a.createElement("div",{className:"gatsby-highlight","data-language":"js"},o.a.createElement("pre",{className:"language-js"},o.a.createElement("code",{className:"language-js"},o.a.createElement("span",{className:"token keyword"},"import")," ",o.a.createElement("span",{className:"token punctuation"},"{")," interpret ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token keyword"},"from")," ",o.a.createElement("span",{className:"token string"},"'xstate/lib/interpreter'"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token keyword"},"const")," searchService ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"interpret"),o.a.createElement("span",{className:"token punctuation"},"("),"searchMachine",o.a.createElement("span",{className:"token punctuation"},")"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"onTransition"),o.a.createElement("span",{className:"token punctuation"},"("),"state ",o.a.createElement("span",{className:"token operator"},"=>")," console",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"log"),o.a.createElement("span",{className:"token punctuation"},"("),"state",o.a.createElement("span",{className:"token punctuation"},"."),"value",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},")"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"start"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n","searchService",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"{")," type",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'SEARCH'"),o.a.createElement("span",{className:"token punctuation"},",")," query",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"''")," ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token comment"},"// => 'idle'"),"\n","\n","searchService",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"{")," type",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'SEARCH'"),o.a.createElement("span",{className:"token punctuation"},",")," query",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'something'")," ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token comment"},"// => 'searching'")))),o.a.createElement(m.MDXTag,{name:"h2",components:a,props:{id:"multiple-guards"}},o.a.createElement(m.MDXTag,{name:"a",components:a,parentName:"h2",props:{href:"#multiple-guards","aria-hidden":!0,class:"anchor"}}),"Multiple Guards"),o.a.createElement(m.MDXTag,{name:"p",components:a},"If you want to have a single event transition to different states in certain situations you can supply an array of conditional transitions."),o.a.createElement(m.MDXTag,{name:"p",components:a},"For example, you can model a door that listens for an ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"OPEN")," event, and opens if you are an admin and errors if you are not:"),o.a.createElement("div",{className:"gatsby-highlight","data-language":"js"},o.a.createElement("pre",{className:"language-js"},o.a.createElement("code",{className:"language-js"},o.a.createElement("span",{className:"token keyword"},"import")," ",o.a.createElement("span",{className:"token punctuation"},"{")," Machine",o.a.createElement("span",{className:"token punctuation"},",")," actions ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token keyword"},"from")," ",o.a.createElement("span",{className:"token string"},"'xstate'"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token keyword"},"import")," ",o.a.createElement("span",{className:"token punctuation"},"{")," interpret ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token keyword"},"from")," ",o.a.createElement("span",{className:"token string"},"'xstate/lib/interpreter'"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token keyword"},"const")," ",o.a.createElement("span",{className:"token punctuation"},"{")," assign ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token operator"},"=")," actions",o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token keyword"},"const")," doorMachine ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"Machine"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"{"),"\n","  ","id",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'door'"),o.a.createElement("span",{className:"token punctuation"},","),"\n","  ","initial",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'closed'"),o.a.createElement("span",{className:"token punctuation"},","),"\n","  ","context",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","    ","isAdmin",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token boolean"},"false"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","  ","states",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","    ","closed",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","      ","initial",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'idle'"),o.a.createElement("span",{className:"token punctuation"},","),"\n","      ","states",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","        ","idle",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","        ","error",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),o.a.createElement("span",{className:"token punctuation"},"}"),"\n","      ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","      ","on",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","        ",o.a.createElement("span",{className:"token constant"},"SET_ADMIN"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token function"},"assign"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},"{")," isAdmin",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token boolean"},"true")," ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},","),"\n","        ",o.a.createElement("span",{className:"token constant"},"OPEN"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"["),"\n","          ",o.a.createElement("span",{className:"token punctuation"},"{")," target",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'opened'"),o.a.createElement("span",{className:"token punctuation"},",")," cond",o.a.createElement("span",{className:"token punctuation"},":")," ctx ",o.a.createElement("span",{className:"token operator"},"=>")," ctx",o.a.createElement("span",{className:"token punctuation"},"."),"isAdmin ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","          ",o.a.createElement("span",{className:"token punctuation"},"{")," target",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'closed.error'")," ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","        ",o.a.createElement("span",{className:"token punctuation"},"]"),"\n","      ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","    ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},","),"\n","    ","opened",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","      ","on",o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","        ",o.a.createElement("span",{className:"token constant"},"CLOSE"),o.a.createElement("span",{className:"token punctuation"},":")," ",o.a.createElement("span",{className:"token string"},"'closed'"),"\n","      ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","    ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"}"),"\n",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token keyword"},"const")," doorService ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"interpret"),o.a.createElement("span",{className:"token punctuation"},"("),"doorMachine",o.a.createElement("span",{className:"token punctuation"},")"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"onTransition"),o.a.createElement("span",{className:"token punctuation"},"("),"state ",o.a.createElement("span",{className:"token operator"},"=>")," console",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"log"),o.a.createElement("span",{className:"token punctuation"},"("),"state",o.a.createElement("span",{className:"token punctuation"},"."),"value",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},")"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"start"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token comment"},"// => ","{"," closed: 'idle' ","}"),"\n","\n","doorService",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token string"},"'OPEN'"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token comment"},"// => ","{"," closed: 'error' ","}"),"\n","\n","doorService",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token string"},"'SET_ADMIN'"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token comment"},"// => ","{"," closed: 'error' ","}"),"\n",o.a.createElement("span",{className:"token comment"},"// (state does not change, but context changes)"),"\n","\n","doorService",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token string"},"'OPEN'"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token comment"},"// => 'opened'"),"\n",o.a.createElement("span",{className:"token comment"},"// (since ctx.isAdmin === true)")))),o.a.createElement(m.MDXTag,{name:"p",components:a},o.a.createElement(m.MDXTag,{name:"strong",components:a,parentName:"p"},"Notes:")),o.a.createElement(m.MDXTag,{name:"ul",components:a},o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"The ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"cond")," function must always be a pure function that only references the ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"context")," and ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"event")," arguments."),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"⚠️ ",o.a.createElement(m.MDXTag,{name:"strong",components:a,parentName:"li"},"Warning"),": do ",o.a.createElement(m.MDXTag,{name:"em",components:a,parentName:"li"},"not")," overuse guard conditions. If something can be represented discretely as two or more separate events instead of multiple ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"conds")," on a single event, it is preferable to avoid ",o.a.createElement(m.MDXTag,{name:"inlineCode",components:a,parentName:"li"},"cond")," and use multiple types of events instead.")))};var p={}}}]);
//# sourceMappingURL=component---src-pages-guides-guards-md-727306854354ada695e9.js.map