{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["interface IState {\n  initial?: string;\n  final?: boolean;\n  states?: {\n    [state: string]: IState;\n  };\n  on?: {\n    [event: string]: string;\n  };\n  toString: () => string;\n}\n\ntype Action = string | {\n  type: string,\n  [key: string]: any,\n};\n\ninterface IMachine extends IState {\n  id?: string;\n  transition: (state: string, action: Action) => IState;\n}\n\nfunction getActionType(action: Action): string {\n  try {\n    return typeof action === 'string'\n      ? action\n      : action.type;\n  } catch(e) {\n    throw new Error('Actions must be strings or objects with a string action.type.')\n  }\n}\n\nfunction getState(machine: IMachine, stateKey: string): IState {\n  const state = machine.states[stateKey];\n\n  if (!state) throw new Error(`State '${stateKey}' does not exist on machine.`);\n\n  return state;\n}\n\nexport default function xstate(machine: IMachine): IMachine {\n  return {\n    ...machine,\n    transition: (stateKey, action) => {\n      const state = machine.states[stateKey];\n\n      if (!state) throw new Error(`State '${stateKey}' does not exist on machine.`);\n\n      if (state.final || !state.on) return state;\n\n      const nextStateKey = state.on[getActionType(action)];\n\n      if (!nextStateKey) throw new Error(`State '${state}' has no transition from action '${getActionType(action)}'`);\n\n      return getState(machine, nextStateKey);\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAsBA,uBAAuB,MAAc;IACnC,IAAI;QACF,OAAO,OAAO,MAAM,KAAK,QAAQ;cAC7B,MAAM;cACN,MAAM,CAAC,IAAI,CAAC;KACjB;IAAC,OAAM,CAAC,EAAE;QACT,MAAM,IAAI,KAAK,CAAC,+DAA+D,CAAC,CAAA;KACjF;CACF;AAED,kBAAkB,OAAiB,EAAE,QAAgB;IACnD,IAAM,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAEvC,IAAI,CAAC,KAAK;QAAE,MAAM,IAAI,KAAK,CAAC,YAAU,QAAQ,iCAA8B,CAAC,CAAC;IAE9E,OAAO,KAAK,CAAC;CACd;AAED,gBAA+B,OAAiB;IAC9C,oBACK,OAAO,IACV,UAAU,EAAE,UAAC,QAAQ,EAAE,MAAM;YAC3B,IAAM,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YAEvC,IAAI,CAAC,KAAK;gBAAE,MAAM,IAAI,KAAK,CAAC,YAAU,QAAQ,iCAA8B,CAAC,CAAC;YAE9E,IAAI,KAAK,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,EAAE;gBAAE,OAAO,KAAK,CAAC;YAE3C,IAAM,YAAY,GAAG,KAAK,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;YAErD,IAAI,CAAC,YAAY;gBAAE,MAAM,IAAI,KAAK,CAAC,YAAU,KAAK,yCAAoC,aAAa,CAAC,MAAM,CAAC,MAAG,CAAC,CAAC;YAEhH,OAAO,QAAQ,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;SACxC,IACF;CACF;;;;"}