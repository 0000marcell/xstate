!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Estado=e():t.Estado=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.parse=e.matchesState=e.mapOnExit=e.mapOnEntry=e.mapState=e.actionFilter=e.stateReducer=e.nfaMachine=e.machine=void 0;var i=n(6),o=r(i),u=n(7),a=n(8),l=r(a),f=n(10),c=r(f),s=n(11),d=n(5),p=r(d),h=n(3);e.machine=o.default,e.nfaMachine=u.machine,e.stateReducer=l.default,e.actionFilter=c.default,e.mapState=s.mapState,e.mapOnEntry=s.mapOnEntry,e.mapOnExit=s.mapOnExit,e.matchesState=p.default,e.parse=h.parse},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var u=i.get;if(void 0!==u)return u.call(r)},f=n(!function(){var t=new Error('Cannot find module "lodash/object/defaults"');throw t.code="MODULE_NOT_FOUND",t}()),c=r(f),s=n(!function(){var t=new Error('Cannot find module "lodash/function/curry"');throw t.code="MODULE_NOT_FOUND",t}()),d=(r(s),n(4)),p=r(d),h=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.options=(0,c.default)(n,{deterministic:!0}),r.mapStateRefs(),r}return u(e,t),a(e,[{key:"transition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"transition",this).call(this,t,n);return this.options.deterministic?!!r.length&&r[0]:r}}]),e}(p.default);e.default=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=n(!function(){var t=new Error('Cannot find module "lodash/lang/isString"');throw t.code="MODULE_NOT_FOUND",t}()),u=r(o),a=n(!function(){var t=new Error('Cannot find module "lodash/lang/isPlainObject"');throw t.code="MODULE_NOT_FOUND",t}()),l=r(a),f=n(!function(){var t=new Error('Cannot find module "lodash/object/extend"');throw t.code="MODULE_NOT_FOUND",t}()),c=r(f),s=function t(e){i(this,t),(e instanceof t||(0,l.default)(e))&&(0,c.default)(this,e),(0,u.default)(e)&&(this.type=e)};e.default=s},function(t,e,n){"use strict";t.exports=function(){function t(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}function e(t,n,r,i){this.message=t,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}function r(t){function r(e){var n,r,i=tt[e];if(i)return i;for(n=e-1;!tt[n];)n--;for(i=tt[n],i={line:i.line,column:i.column,seenCR:i.seenCR};n<e;)r=t.charAt(n),"\n"===r?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1),n++;return tt[e]=i,i}function i(t,e){var n=r(t),i=r(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:i.line,column:i.column}}}function o(t){Z<et||(Z>et&&(et=Z,nt=[]),nt.push(t))}function u(t,n,r,i){function o(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}function u(t,e){function n(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+e(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+e(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+e(t)})}var r,i,o,u=new Array(t.length);for(o=0;o<t.length;o++)u[o]=t[o].description;return r=t.length>1?u.slice(0,-1).join(", ")+" or "+u[t.length-1]:u[0],i=e?'"'+n(e)+'"':"end of input","Expected "+r+" but "+i+" found."}return null!==n&&o(n),new e(null!==t?t:u(n,r),n,r,i)}function a(){var t,e,n;for(t=Z,e=[],n=f();n!==O;)e.push(n),n=f();return e!==O&&($=t,e=w(e)),t=e}function l(){var e,n,r,i,u,a,l;for(e=Z,n=[],r=v();r!==O;)n.push(r),r=v();if(n!==O)if(123===t.charCodeAt(Z)?(r=E,Z++):(r=O,0===rt&&o(M)),r!==O){for(i=[],u=f();u!==O;)i.push(u),u=f();if(i!==O)if(125===t.charCodeAt(Z)?(u=j,Z++):(u=O,0===rt&&o(x)),u!==O){for(a=[],l=v();l!==O;)a.push(l),l=v();a!==O?($=e,n=C(i),e=n):(Z=e,e=O)}else Z=e,e=O;else Z=e,e=O}else Z=e,e=O;else Z=e,e=O;return e}function f(){var t,e,n,r,i,o,u,a,f,s,p;for(t=Z,e=[],n=v();n!==O;)e.push(n),n=v();if(e!==O)if(n=c(),n!==O){for(r=[],i=v();i!==O;)r.push(i),i=v();if(r!==O)if(i=h(),i===O&&(i=null),i!==O){for(o=[],u=v();u!==O;)o.push(u),u=v();if(o!==O)if(u=l(),u===O&&(u=null),u!==O){for(a=[],f=v();f!==O;)a.push(f),f=v();if(a!==O){for(f=[],s=d();s!==O;)f.push(s),s=d();if(f!==O){for(s=[],p=v();p!==O;)s.push(p),p=v();s!==O?($=t,e=S(n,i,u,f),t=e):(Z=t,t=O)}else Z=t,t=O}else Z=t,t=O}else Z=t,t=O;else Z=t,t=O}else Z=t,t=O;else Z=t,t=O}else Z=t,t=O;else Z=t,t=O;return t}function c(){var t,e,n;if(t=Z,e=[],n=y(),n!==O)for(;n!==O;)e.push(n),n=y();else e=O;return e!==O&&($=t,e=D(e)),t=e}function s(){var e,n,r,i,u;return e=Z,n=c(),n!==O?(r=Z,46===t.charCodeAt(Z)?(i=U,Z++):(i=O,0===rt&&o(N)),i!==O?(u=s(),u!==O?(i=[i,u],r=i):(Z=r,r=O)):(Z=r,r=O),r===O&&(r=null),r!==O?($=e,n=F(n,r),e=n):(Z=e,e=O)):(Z=e,e=O),e}function d(){var e,n,r,i,u;if(e=Z,t.substr(Z,2)===A?(n=A,Z+=2):(n=O,0===rt&&o(T)),n!==O){for(r=[],i=v();i!==O;)r.push(i),i=v();r!==O?(i=s(),i!==O?(u=p(),u===O&&(u=null),u!==O?($=e,n=P(i,u),e=n):(Z=e,e=O)):(Z=e,e=O)):(Z=e,e=O)}else Z=e,e=O;if(e===O)if(e=Z,t.substr(Z,2)===R?(n=R,Z+=2):(n=O,0===rt&&o(k)),n!==O){for(r=[],i=v();i!==O;)r.push(i),i=v();r!==O?(i=p(),i===O&&(i=null),i!==O?($=e,n=L(i),e=n):(Z=e,e=O)):(Z=e,e=O)}else Z=e,e=O;return e}function p(){var e,n,r,i,u,a,l,f,c;for(e=Z,n=[],r=v();r!==O;)n.push(r),r=v();if(n!==O)if(40===t.charCodeAt(Z)?(r=I,Z++):(r=O,0===rt&&o(z)),r!==O){for(i=[],u=v();u!==O;)i.push(u),u=v();if(i!==O)if(u=y(),u!==O){for(a=[],l=v();l!==O;)a.push(l),l=v();if(a!==O)if(41===t.charCodeAt(Z)?(l=V,Z++):(l=O,0===rt&&o(q)),l!==O){for(f=[],c=v();c!==O;)f.push(c),c=v();f!==O?($=e,n=B(u),e=n):(Z=e,e=O)}else Z=e,e=O;else Z=e,e=O}else Z=e,e=O;else Z=e,e=O}else Z=e,e=O;else Z=e,e=O;return e}function h(){var e,n;return e=Z,33===t.charCodeAt(Z)?(n=G,Z++):(n=O,0===rt&&o(H)),n!==O&&($=e,n=J(n)),e=n}function v(){var e;return K.test(t.charAt(Z))?(e=t.charAt(Z),Z++):(e=O,0===rt&&o(Q)),e}function y(){var e,n,r;if(e=Z,n=[],W.test(t.charAt(Z))?(r=t.charAt(Z),Z++):(r=O,0===rt&&o(X)),r!==O)for(;r!==O;)n.push(r),W.test(t.charAt(Z))?(r=t.charAt(Z),Z++):(r=O,0===rt&&o(X));else n=O;return n!==O&&($=e,n=Y(n)),e=n}var _,g=arguments.length>1?arguments[1]:{},O={},m={Machine:a},b=a,w=function(t){return t.length&&(t[0].initial=!0),new it({states:t})},E="{",M={type:"literal",value:"{",description:'"{"'},j="}",x={type:"literal",value:"}",description:'"}"'},C=function(t){return t.length&&(t[0].initial=!0),t},S=function(t,e,n,r){return{id:t,final:!!e,states:n||[],transitions:r.map(function(e){return{target:e.target===!0?t:e.target,event:e.event}})}},D=function(t){return t.join("")},U=".",N={type:"literal",value:".",description:'"."'},F=function(t,e){return[t,(e||[]).join("")].join("")},A="->",T={type:"literal",value:"->",description:'"->"'},P=function(t,e){return{target:t,event:e}},R="<-",k={type:"literal",value:"<-",description:'"<-"'},L=function(t){return{target:!0,event:t}},I="(",z={type:"literal",value:"(",description:'"("'},V=")",q={type:"literal",value:")",description:'")"'},B=function(t){return t},G="!",H={type:"literal",value:"!",description:'"!"'},J=function(t){return!!t},K=/^[ \n\t]/,Q={type:"class",value:"[ \\n\\t]",description:"[ \\n\\t]"},W=/^[a-z0-9_]/i,X={type:"class",value:"[a-z0-9\\_]i",description:"[a-z0-9\\_]i"},Y=function(t){return t.join("")},Z=0,$=0,tt=[{line:1,column:1,seenCR:!1}],et=0,nt=[],rt=0;if("startRule"in g){if(!(g.startRule in m))throw new Error("Can't start parsing from rule \""+g.startRule+'".');b=m[g.startRule]}var it=(n(4),n(1));if(_=b(),_!==O&&Z===t.length)return _;throw _!==O&&Z<t.length&&o({type:"end",description:"end of input"}),u(null,nt,et<t.length?t.charAt(et):null,et<t.length?i(et,et+1):i(et,et))}return t(e,Error),{SyntaxError:e,parse:r}}()},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(9),a=r(u),l=n(!function(){var t=new Error('Cannot find module "lodash/array/difference"');throw t.code="MODULE_NOT_FOUND",t}()),f=r(l),c=n(!function(){var t=new Error('Cannot find module "lodash/array/unique"');throw t.code="MODULE_NOT_FOUND",t}()),s=r(c),d=n(!function(){var t=new Error('Cannot find module "lodash/lang/isArray"');throw t.code="MODULE_NOT_FOUND",t}()),p=r(d),h=n(!function(){var t=new Error('Cannot find module "lodash/lang/isString"');throw t.code="MODULE_NOT_FOUND",t}()),v=r(h),y=n(!function(){var t=new Error('Cannot find module "lodash/collection/find"');throw t.code="MODULE_NOT_FOUND",t}()),_=r(y),g=n(3),O=n(2),m=r(O),b=".",w=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;i(this,t),e=(0,v.default)(e)?(0,g.parse)(e):e,this.id=e.id||"root",this._id=r?r._id.concat(this.id):[this.id],this.states=e.states?e.states.map(function(e){return new t(e,n)}):[],this.transitions=e.transitions?e.transitions.map(function(t){return new a.default(t)}):[],this.alphabet=this.getAlphabet(),this.initial=!!e.initial,this.final=!!e.final}return o(t,[{key:"mapStateRefs",value:function(){var t=this;return this.states=this.states.map(function(e){return e.transitions=e.transitions.map(function(e){return e.targetState=t.getState(e.target),Object.freeze(e)}),e.mapStateRefs()}),Object.freeze(this)}},{key:"relativeId",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,f.default)(this._id,t._id).join(".")}},{key:"transition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getSubstateIds(t),o=this.states.filter(function(t){return t.initial}),u=[],a=i.length?this.getState(i[0]):null;if(i.length){if(!a)return[];u=a.transition(i.slice(1),n,!1),u.length||(u=this.transitions.filter(function(t){return t.isValid(n)}).map(function(t){return t.targetState.initialStates()}).reduce(function(t,e){return t.concat(e)},[]))}else u=o.length?o.map(function(t){return t.transition(null,n,!1)}).reduce(function(t,e){return t.concat(e)},[]):n?this.transitions.filter(function(t){return t.isValid(n)}).map(function(t){return t.targetState.initialStates()}).reduce(function(t,e){return t.concat(e)},[]):this.initialStates();return r?u.map(function(t){return t.relativeId(e)}):u}},{key:"initialStates",value:function(){var t=this.states.filter(function(t){return t.initial});return t.length?t.map(function(t){return t.initialStates()}).reduce(function(t,e){return t.concat(e)},[]):[this]}},{key:"getSubstateIds",value:function(e){return e?e instanceof t?e._id:(e=e||[],(0,p.default)(e)?e:!!(0,v.default)(e)&&e.split(b)):[]}},{key:"getState",value:function(e){if(e instanceof t)return e;if(e=this.getSubstateIds(e),!e.length)return this;var n=(0,_.default)(this.states,function(t){return t.id===e[0]});return!!n&&(e.length>1?n.getState(e.slice(1)):n)}},{key:"getAlphabet",value:function(){return this.alphabet||(0,s.default)(this.states.map(function(t){return t.getAlphabet()}).concat(this.transitions.map(function(t){return t.event})).reduce(function(t,e){return t.concat(e)},[]))}},{key:"isValidAction",value:function(t){if(!t)return!1;var e=new m.default(t).type;return this.getAlphabet().indexOf(e)!==-1}}]),t}();e.default=w},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(t===e)return!0;if(!t||!e)return!1;var n=[t,e].map(function(t){return t.split(".").map(function(t,e){return t+e})}),r=o(n,2),i=r[0],u=r[1];return(0,a.default)(i,u).length===i.length}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.default=i;var u=n(!function(){var t=new Error('Cannot find module "lodash/array/union"');throw t.code="MODULE_NOT_FOUND",t}()),a=r(u)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return new u.default(t,{deterministic:!0})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var o=n(1),u=r(o)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return new u.default(t,{deterministic:!1})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var o=n(1),u=r(o)},function(t,e){"use strict";function n(t){var e=t.transition();return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments[1];return r&&t.isValidAction(r)?t.transition(n,r):n}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(){return!0}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),l=r(a),f=function(){function t(e,n){i(this,t),this.event=e.event,this.target=e.target,this.cond=e.cond||o}return u(t,[{key:"isValid",value:function(t){return t=new l.default(t),t.type===this.event&&!!this.cond(t)}}]),t}();e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},e=arguments[1];return function(n,r){return n?t(r)?e(n,r):n:e()}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(!function(){var t=new Error('Cannot find module "lodash/function/curry"');throw t.code="MODULE_NOT_FOUND",t}()),u=r(o);e.default=(0,u.default)(i)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.mapOnExit=e.mapOnEntry=e.mapState=void 0;var i=n(5),o=r(i),u=n(!function(){var t=new Error('Cannot find module "lodash/collection/find"');throw t.code="MODULE_NOT_FOUND",t}()),a=(r(u),n(!function(){var t=new Error('Cannot find module "lodash/collection/filter"');throw t.code="MODULE_NOT_FOUND",t}())),l=(r(a),n(!function(){var t=new Error('Cannot find module "lodash/collection/max"');throw t.code="MODULE_NOT_FOUND",t}())),f=r(l),c=n(!function(){var t=new Error('Cannot find module "lodash/function/curry"');throw t.code="MODULE_NOT_FOUND",t}()),s=r(c),d=function(t,e){var n=Object.keys(t).filter(function(t){return(0,o.default)(e,t)});return n.length?(0,f.default)(n,function(t){return t.length}):null},p=(0,s.default)(function(t,e){var n=d(t,e);return n?t[n]:null}),h=(0,s.default)(function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,o.default)(n,e))return null;var r=d(t,e);return r!==e?h(t,r,n):t[r]}),v=(0,s.default)(function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,o.default)(e,n))return null;var r=d(t,n);return r!==n?v(t,e,r):t[r]});e.mapState=p,e.mapOnEntry=h,e.mapOnExit=v}])});