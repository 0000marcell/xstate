<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Actors | XState Docs</title>
    <meta name="description" content="Documentation for XState: State Machines and Statecharts for the Modern Web">
    
    
    <link rel="preload" href="/docs/assets/css/0.styles.04bea4c9.css" as="style"><link rel="preload" href="/docs/assets/js/app.a0bf3501.js" as="script"><link rel="preload" href="/docs/assets/js/3.112a8da6.js" as="script"><link rel="preload" href="/docs/assets/js/15.1305f646.js" as="script"><link rel="preload" href="/docs/assets/js/4.7e654600.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.b974159c.js"><link rel="prefetch" href="/docs/assets/js/11.1b879fb3.js"><link rel="prefetch" href="/docs/assets/js/12.6b72aff7.js"><link rel="prefetch" href="/docs/assets/js/13.dc5cbc64.js"><link rel="prefetch" href="/docs/assets/js/14.5d26eafd.js"><link rel="prefetch" href="/docs/assets/js/16.53cf4eca.js"><link rel="prefetch" href="/docs/assets/js/17.4fe317ca.js"><link rel="prefetch" href="/docs/assets/js/18.83ea9502.js"><link rel="prefetch" href="/docs/assets/js/19.35751f66.js"><link rel="prefetch" href="/docs/assets/js/20.ccdc63f6.js"><link rel="prefetch" href="/docs/assets/js/21.b6ba9f6a.js"><link rel="prefetch" href="/docs/assets/js/22.8ad7ab70.js"><link rel="prefetch" href="/docs/assets/js/23.2513f6e3.js"><link rel="prefetch" href="/docs/assets/js/24.012dbf12.js"><link rel="prefetch" href="/docs/assets/js/25.b0ed6bb0.js"><link rel="prefetch" href="/docs/assets/js/26.6039b848.js"><link rel="prefetch" href="/docs/assets/js/27.94a8bcce.js"><link rel="prefetch" href="/docs/assets/js/28.8b76f663.js"><link rel="prefetch" href="/docs/assets/js/29.2a202426.js"><link rel="prefetch" href="/docs/assets/js/30.26bdf47a.js"><link rel="prefetch" href="/docs/assets/js/31.2bd9d627.js"><link rel="prefetch" href="/docs/assets/js/32.abcbaea1.js"><link rel="prefetch" href="/docs/assets/js/33.15a1da62.js"><link rel="prefetch" href="/docs/assets/js/34.960ef67d.js"><link rel="prefetch" href="/docs/assets/js/35.fed126f1.js"><link rel="prefetch" href="/docs/assets/js/36.80b5d181.js"><link rel="prefetch" href="/docs/assets/js/37.34a665c2.js"><link rel="prefetch" href="/docs/assets/js/38.75e04234.js"><link rel="prefetch" href="/docs/assets/js/39.f6db1421.js"><link rel="prefetch" href="/docs/assets/js/40.e175cc62.js"><link rel="prefetch" href="/docs/assets/js/41.16577c91.js"><link rel="prefetch" href="/docs/assets/js/42.b99281e0.js"><link rel="prefetch" href="/docs/assets/js/43.a9dd398e.js"><link rel="prefetch" href="/docs/assets/js/44.e014d7d9.js"><link rel="prefetch" href="/docs/assets/js/45.a563b0a4.js"><link rel="prefetch" href="/docs/assets/js/46.e0385911.js"><link rel="prefetch" href="/docs/assets/js/47.f75611c7.js"><link rel="prefetch" href="/docs/assets/js/5.88dc539a.js"><link rel="prefetch" href="/docs/assets/js/6.67658eb3.js"><link rel="prefetch" href="/docs/assets/js/7.2acca6ac.js"><link rel="prefetch" href="/docs/assets/js/8.5bbd6236.js"><link rel="prefetch" href="/docs/assets/js/9.f6ef8ad3.js"><link rel="prefetch" href="/docs/assets/js/vendors~docsearch.086ca35a.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.04bea4c9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/logo.svg" alt="XState Docs" class="logo"> <span class="site-name can-hide">XState Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://xstate.js.org/api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://statecharts.github.io/xstate-viz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Visualizer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitter.im/statecharts/statecharts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Chat
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://spectrum.chat/statecharts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/davidkpiano/xstate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://xstate.js.org/api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://statecharts.github.io/xstate-viz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Visualizer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitter.im/statecharts/statecharts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Chat
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://spectrum.chat/statecharts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/davidkpiano/xstate" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>About</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Guides</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/guides/start.html" class="sidebar-link">Getting Started</a></li><li><a href="/docs/guides/installation.html" class="sidebar-link">Installation</a></li><li><a href="/docs/guides/machines.html" class="sidebar-link">Machines</a></li><li><a href="/docs/guides/states.html" class="sidebar-link">States</a></li><li><a href="/docs/guides/statenodes.html" class="sidebar-link">State Nodes</a></li><li><a href="/docs/guides/events.html" class="sidebar-link">Events</a></li><li><a href="/docs/guides/transitions.html" class="sidebar-link">Transitions</a></li><li><a href="/docs/guides/hierarchical.html" class="sidebar-link">Hierarchical State Nodes</a></li><li><a href="/docs/guides/parallel.html" class="sidebar-link">Parallel State Nodes</a></li><li><a href="/docs/guides/effects.html" class="sidebar-link">Effects</a></li><li><a href="/docs/guides/actions.html" class="sidebar-link">Actions</a></li><li><a href="/docs/guides/guards.html" class="sidebar-link">Guards</a></li><li><a href="/docs/guides/context.html" class="sidebar-link">Context</a></li><li><a href="/docs/guides/activities.html" class="sidebar-link">Activities</a></li><li><a href="/docs/guides/communication.html" class="sidebar-link">Invoking Services</a></li><li><a href="/docs/guides/actors.html" class="active sidebar-link">Actors</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#actor-api" class="sidebar-link">Actor API</a></li><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#spawning-actors" class="sidebar-link">Spawning actors</a></li><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#sending-events-to-actors" class="sidebar-link">Sending events to actors</a></li><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#spawning-promises" class="sidebar-link">Spawning Promises</a></li><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#spawning-callbacks" class="sidebar-link">Spawning Callbacks</a></li><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#spawning-observables" class="sidebar-link">Spawning Observables</a></li><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#spawning-machines" class="sidebar-link">Spawning Machines</a></li><li class="sidebar-sub-header"><a href="/docs/guides/actors.html#quick-reference" class="sidebar-link">Quick Reference</a></li></ul></li><li><a href="/docs/guides/delays.html" class="sidebar-link">Delayed Events and Transitions</a></li><li><a href="/docs/guides/final.html" class="sidebar-link">Final States</a></li><li><a href="/docs/guides/history.html" class="sidebar-link">History</a></li><li><a href="/docs/guides/ids.html" class="sidebar-link">Identifying State Nodes</a></li><li><a href="/docs/guides/interpretation.html" class="sidebar-link">Interpreting Machines</a></li><li><a href="/docs/guides/typescript.html" class="sidebar-link">Using TypeScript</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Recipes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Packages</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Patterns</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Examples</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="actors"><a href="#actors" aria-hidden="true" class="header-anchor">#</a> Actors <span class="badge tip" style="vertical-align:top;" data-v-c13ee5b0>4.6+</span></h1> <p><a href="#quick-reference">🚀 Quick Reference</a></p> <p>The <a href="https://en.wikipedia.org/wiki/Actor_model" target="_blank" rel="noopener noreferrer">Actor model<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is a mathematical model of message-based computation that simplifies how multiple &quot;entities&quot; (or &quot;actors&quot;) communicate with each other. Actors communicate by sending messages (events) to each other. An actor's local state is private, unless it wishes to share it with another actor, by sending it as an event.</p> <p>When an actor receives an event, three things can happen:</p> <ul><li>A finite number of messages can be <strong>sent</strong> to other actors</li> <li>A finite number of new actors can be created (or <strong>spawned</strong>)</li> <li>The actor's local state may change (determined by its <strong>behavior</strong>)</li></ul> <p>State machines and statecharts work very well with the actor model, as they are event-based models of behavior and logic. Remember: when a state machine transitions due to an event, the next state contains:</p> <ul><li>The next <code>value</code> and <code>context</code> (an actor's local state)</li> <li>The next <code>actions</code> to be executed (potentially newly spawned actors or messages sent to other actors)</li></ul> <blockquote><p>Think of actors like dynamic services in XState.</p></blockquote> <p>Actors can be considered a dynamic variant of <a href="/docs/guides/communication.html">invoked services</a> (same internal implementation!) with two important differences:</p> <ul><li>They can be <em>spawned</em> at any time (as an action)</li> <li>They can be <em>stopped</em> at any time (as an action)</li></ul> <h2 id="actor-api"><a href="#actor-api" aria-hidden="true" class="header-anchor">#</a> Actor API</h2> <p>An actor (as implemented in XState) has an interface of:</p> <ul><li>An <code>id</code> property, which uniquely identifies the actor in the local system</li> <li>A <code>.send(...)</code> method, which is used to send events to this actor</li></ul> <p>They may have optional methods:</p> <ul><li>A <code>.stop()</code> method which stops the actor and performs any necessary cleanup</li> <li>A <code>.subscribe(...)</code> method for actors that are <a href="https://github.com/tc39/proposal-observable" target="_blank" rel="noopener noreferrer">Observable<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul> <p>All the existing invoked service patterns fit this interface:</p> <ul><li><a href="/docs/guides/communication.html#invoking-promises">Invoked promises</a> are actors that ignore any received events and send at most one event back to the parent</li> <li><a href="/docs/guides/communication.html#invoking-callbacks">Invoked callbacks</a> are actors that can send events to the parent (first <code>callback</code> argument), receive events (second <code>onReceive</code> argument), and act on them</li> <li><a href="/docs/guides/communication.html#invoking-machines">Invoked machines</a> are actors that can send events to the parent (<code>sendParent(...)</code> action) or other actors it has references to (<code>send(...)</code> action), receive events, act on them (state transitions and actions), spawn new actors (<code>spawn(...)</code> function), and stop actors.</li> <li><a href="/docs/guides/communication.html#invoking-observables">Invoked observables</a> are actors whose emitted values represent events to be sent back to the parent.</li></ul> <h2 id="spawning-actors"><a href="#spawning-actors" aria-hidden="true" class="header-anchor">#</a> Spawning actors</h2> <p>Just as in Actor-model-based languages like <a href="https://doc.akka.io/docs/akka/current/guide/introduction.html" target="_blank" rel="noopener noreferrer">Akka<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or <a href="http://www.erlang.org/docs" target="_blank" rel="noopener noreferrer">Erlang<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, actors are spawned and referenced in <code>context</code> (as the result of an <code>assign(...)</code> action).</p> <ol><li>Import the <code>spawn</code> function from <code>'xstate'</code></li> <li>In an <code>assign(...)</code> action, create a new actor reference with <code>spawn(...)</code></li></ol> <p>The <code>spawn(...)</code> function creates an <strong>actor reference</strong> by providing 1 or 2 arguments:</p> <ul><li><code>entity</code> - the (reactive) value or machine that represents the behavior of the actor. Possible types for <code>entity</code>:
<ul><li><a href="/docs/guides/communication.html#invoking-machines">Machine</a></li> <li><a href="/docs/guides/communication.html#invoking-promises">Promise</a></li> <li><a href="/docs/guides/communication.html#invoking-callbacks">Callback</a></li> <li>Observable</li></ul></li> <li><code>name</code> (optional) - a string uniquely identifying the actor. This should be unique for all spawned actors and invoked services.</li></ul> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Machine<span class="token punctuation">,</span> spawn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> todoMachine <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./todoMachine'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> todosMachine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'NEW_TODO.ADD'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">todos</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
          <span class="token operator">...</span>context<span class="token punctuation">.</span>todos<span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            todo<span class="token punctuation">:</span> event<span class="token punctuation">.</span>todo<span class="token punctuation">,</span>
            <span class="token comment">// add a new todoMachine actor with a unique name</span>
            ref<span class="token punctuation">:</span> <span class="token function">spawn</span><span class="token punctuation">(</span>todoMachine<span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`todo-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you do not provide a <code>name</code> argument to <code>spawn(...)</code>, a unique name will be automatically generated. This name will be nondeterministic ⚠️.</p> <div class="tip custom-block"><p>Treat <code>const actorRef = spawn(someMachine)</code> as just a normal value in <code>context</code>. You can place this <code>actorRef</code> anywhere within <code>context</code>, based on your logic requirements. As long as it's within an assignment function in <code>assign(...)</code>, it will be scoped to the service from where it was spawned.</p></div> <div class="warning custom-block"><p>Do not call <code>spawn(...)</code> outside of an assignment function. This will produce an orphaned actor (without a parent) which will have no effect.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ❌ Never call spawn(...) externally</span>
<span class="token keyword">const</span> someActorRef <span class="token operator">=</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ❌ spawn(...) is not an action creator</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ❌ Do not assign spawn(...) outside of an assignment function</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// remember: this is called immediately, before a service starts</span>
    someActorRef<span class="token punctuation">:</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ✅ Assign spawn(...) inside an assignment function</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">someActorRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p>Different types of values can be spawned as actors.</p> <h2 id="sending-events-to-actors"><a href="#sending-events-to-actors" aria-hidden="true" class="header-anchor">#</a> Sending events to actors</h2> <p>With the <a href="/docs/guides/actions.html#send-action"><code>send()</code> action</a>, events can be sent to actors via a <a href="/docs/guides/actions.html#send-targets">target expression</a>:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  states<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    active<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      entry<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">someRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token constant">SOME_EVENT</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// Use a target expression to send an event</span>
          <span class="token comment">// to the actor reference</span>
          actions<span class="token punctuation">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'PING'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">to</span><span class="token punctuation">:</span> <span class="token parameter">context</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>someRef
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="spawning-promises"><a href="#spawning-promises" aria-hidden="true" class="header-anchor">#</a> Spawning Promises</h2> <p>Just like <a href="/docs/guides/communication.html#invoking-promises">invoking promises</a>, promises can be spawned as actors. The event sent back to the machine will be a <code>'done.invoke.&lt;ID&gt;'</code> action with the promise response as the <code>data</code> property in the payload:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// Returns a promise</span>
<span class="token keyword">const</span> <span class="token function-variable function">fetchData</span> <span class="token operator">=</span> <span class="token parameter">query</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`http://example.com?query=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span>
    data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">ref</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token function">fetchData</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><div class="tip custom-block"><p>It is not recommended to spawn promise actors, as <a href="/docs/guides/communication.html#invoking-promises">invoking promises</a> is a better pattern for this, since they are dependent on state (self-cancelling) and have more predictable behavior.</p></div> <h2 id="spawning-callbacks"><a href="#spawning-callbacks" aria-hidden="true" class="header-anchor">#</a> Spawning Callbacks</h2> <p>Just like <a href="/docs/guides/communication.html#invoking-callbacks">invoking callbacks</a>, callbacks can be spawned as actors. This example models a counter-interval actor that increments its own count every second, but can also react to <code>{ type: 'INC' }</code> events.</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">counterInterval</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> receive</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'COUNT.UPDATE'</span><span class="token punctuation">,</span> count <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">receive</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'INC'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      count<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token punctuation">{</span>
    actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">counterRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>counterInterval<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Events can then be sent to the actor:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'COUNTER.INC'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      actions<span class="token punctuation">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'INC'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">to</span><span class="token punctuation">:</span> <span class="token parameter">context</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>ref
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="spawning-observables"><a href="#spawning-observables" aria-hidden="true" class="header-anchor">#</a> Spawning Observables</h2> <p>Just like <a href="/docs/guides/communication.html#invoking-observables">invoking observables</a>, observables can be spawned as actors:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> interval <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> map <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs/operators'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">createCounterObservable</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">interval</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">count</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'COUNT.UPDATE'</span><span class="token punctuation">,</span> count <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  context<span class="token punctuation">:</span> <span class="token punctuation">{</span> ms<span class="token punctuation">:</span> <span class="token number">1000</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
  <span class="token punctuation">{</span>
    actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">counterRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> ms <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token function">createCounterObservable</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
  on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'COUNT.UPDATE'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="spawning-machines"><a href="#spawning-machines" aria-hidden="true" class="header-anchor">#</a> Spawning Machines</h2> <p>Machines are the most effective way to use actors, since they offer the most capabilities. Spawning machines is just like <a href="/docs/guides/communication.html#invoking-machines">invoking machines</a>, where a <code>machine</code> is passed into <code>spawn(machine)</code>:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> remoteMachine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token string">'remote'</span><span class="token punctuation">,</span>
  initial<span class="token punctuation">:</span> <span class="token string">'offline'</span><span class="token punctuation">,</span>
  states<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    offline<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token constant">WAKE</span><span class="token punctuation">:</span> <span class="token string">'online'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    online<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      after <span class="token punctuation">{</span>
        <span class="token number">1000</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          actions<span class="token punctuation">:</span> <span class="token function">sendParent</span><span class="token punctuation">(</span><span class="token string">'REMOTE.ONLINE'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> parentMachine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token string">'parent'</span><span class="token punctuation">,</span>
  initial<span class="token punctuation">:</span> <span class="token string">'waiting'</span><span class="token punctuation">,</span>
  states<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    waiting<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      entry<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">localOne</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>remoteMachine<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'LOCAL.WAKE'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          actions<span class="token punctuation">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'WAKE'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">to</span><span class="token punctuation">:</span> <span class="token parameter">context</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>localOne
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'REMOTE.ONLINE'</span><span class="token punctuation">:</span> <span class="token string">'connected'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    connected<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> parentService <span class="token operator">=</span> <span class="token function">interpret</span><span class="token punctuation">(</span>parentMachine<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">onTransition</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

parentService<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'LOCAL.WAKE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; 'waiting'</span>
<span class="token comment">// ... after 1000ms</span>
<span class="token comment">// =&gt; 'connected'</span>
</code></pre></div><h3 id="syncing-and-reading-state"><a href="#syncing-and-reading-state" aria-hidden="true" class="header-anchor">#</a> Syncing and Reading State <span class="badge tip" style="vertical-align:top;" data-v-c13ee5b0>4.6.1+</span></h3> <p>One of the main tenets of the Actor model is that actor state is <em>private</em> and <em>local</em> - it is never shared unless the actor chooses to share it, via message passing. Sticking with this model, an actor can <em>notify</em> its parent whenever its state changes by sending it a special &quot;update&quot; event with its latest state. In other words, parent actors can subscribe to their child actors' states.</p> <p>To do this, set <code>{ sync: true }</code> as an option to <code>spawn(...)</code>:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">someRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>todoMachine<span class="token punctuation">,</span> <span class="token punctuation">{</span> sync<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p>This will automatically subscribe the machine to the spawned child machine's state, which is kept updated in <code>ref.state</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>someService<span class="token punctuation">.</span><span class="token function">onTransition</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> someRef <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>context<span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>someRef<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// =&gt; State {</span>
  <span class="token comment">//   value: ...,</span>
  <span class="token comment">//   context: ...</span>
  <span class="token comment">// }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>By default, <code>sync</code> is set to <code>false</code>; that is, <code>ref.state === undefined</code>.</p> <div class="warning custom-block"><p>Prefer sending events to the parent explicitly (<code>sendParent(...)</code>) rather than subscribing to every state change. Syncing with spawned machines can result in &quot;chatty&quot; event logs, since every update from the child results in a new <code>&quot;xstate.update&quot;</code> event sent from the child to the parent. Here is an example alternative pattern:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// Child machine</span>
<span class="token comment">// ...</span>
on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token constant">CHANGE</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">value</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> event<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token constant">SAVE</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// Only notify parent of changes on SAVE event</span>
    actions<span class="token punctuation">:</span> <span class="token function">sendParent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> <span class="token string">'UPDATE_FROM_CHILD'</span><span class="token punctuation">,</span>
      data<span class="token punctuation">:</span> context
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div></div> <h2 id="quick-reference"><a href="#quick-reference" aria-hidden="true" class="header-anchor">#</a> Quick Reference</h2> <p><strong>Import <code>spawn</code></strong> to spawn actors:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> spawn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xstate'</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Spawn actors</strong> in <code>assign</code> action creators:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">someRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p><strong>Spawn different types</strong> of actors:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// From a promise</span>
    <span class="token function-variable function">promiseRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token function">spawn</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// ...</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'my-promise'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment">// From a callback</span>
    <span class="token function-variable function">callbackRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> receive</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// send to parent</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'SOME_EVENT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// receive from parent</span>
        <span class="token function">receive</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// handle event</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// disposal</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">/* do cleanup here */</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment">// From an observable</span>
    <span class="token function-variable function">observableRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someEvent$<span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment">// From a machine</span>
    <span class="token function-variable function">machineRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token function">spawn</span><span class="token punctuation">(</span>
        <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token comment">// ...</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p><strong>Sync state</strong> with an actor: <span class="badge tip" style="vertical-align:top;" data-v-c13ee5b0>4.6.1+</span></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">someRef</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">spawn</span><span class="token punctuation">(</span>someMachine<span class="token punctuation">,</span> <span class="token punctuation">{</span> spawn<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p><strong>Reading synced state</strong> from an actor: <span class="badge tip" style="vertical-align:top;" data-v-c13ee5b0>4.6.1+</span></p> <div class="language-js extra-class"><pre class="language-js"><code>service<span class="token punctuation">.</span><span class="token function">onTransition</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> someRef <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>context<span class="token punctuation">;</span>

  someRef<span class="token punctuation">.</span>state<span class="token punctuation">;</span>
  <span class="token comment">// =&gt; State { ... }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Send event to actor</strong> with <code>send</code> action creator:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'SOME_EVENT'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">to</span><span class="token punctuation">:</span> <span class="token parameter">context</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>someRef
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p><strong>Send event from actor</strong> to parent with <code>sendParent</code> action creator:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token punctuation">{</span>
  actions<span class="token punctuation">:</span> <span class="token function">sendParent</span><span class="token punctuation">(</span><span class="token string">'ANOTHER_EVENT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p><strong>Reference actors</strong> from <code>context</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>someService<span class="token punctuation">.</span><span class="token function">onTransition</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> someRef <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>context<span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>someRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// =&gt; { id: ..., send: ... }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/davidkpiano/xstate/edit/master/docs/guides/actors.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/19/2019, 9:11:06 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs/guides/communication.html" class="prev">
          Invoking Services
        </a></span> <span class="next"><a href="/docs/guides/delays.html">
          Delayed Events and Transitions
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.a0bf3501.js" defer></script><script src="/docs/assets/js/3.112a8da6.js" defer></script><script src="/docs/assets/js/15.1305f646.js" defer></script><script src="/docs/assets/js/4.7e654600.js" defer></script>
  </body>
</html>
