(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{158:function(e,a,n){"use strict";n.r(a),n.d(a,"_frontmatter",function(){return r});var t=n(167),s=n.n(t),c=n(0),o=n.n(c),m=n(168),l=n(169);a.default=function(e){var a=e.components,n=s()(e,["components"]);return o.a.createElement(m.MDXTag,{name:"wrapper",Layout:l.a,layoutProps:n,components:a},o.a.createElement(m.MDXTag,{name:"h1",components:a,props:{id:"interpreting-machines"}},o.a.createElement(m.MDXTag,{name:"a",components:a,parentName:"h1",props:{href:"#interpreting-machines","aria-hidden":!0,class:"anchor"}}),"Interpreting machines"),o.a.createElement(m.MDXTag,{name:"p",components:a},'While a "stateless" state machine/statechart is useful for flexibility, purity, and testability, in order for it to have any use in a real-life application, something needs to:'),o.a.createElement(m.MDXTag,{name:"ul",components:a},o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Keep track of the current state, and persist it"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Execute side-effects"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Handle delayed transitions and events"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Communicate with external services")),o.a.createElement(m.MDXTag,{name:"p",components:a},"The ",o.a.createElement(m.MDXTag,{name:"strong",components:a,parentName:"p"},"interpreter")," is responsible for ",o.a.createElement(m.MDXTag,{name:"em",components:a,parentName:"p"},"interpreting")," the state machine/statechart and doing all of the above - that is, parsing and executing it in a runtime environment. An interpreted, running instance of a statechart is called a ",o.a.createElement(m.MDXTag,{name:"strong",components:a,parentName:"p"},"service"),". "),o.a.createElement(m.MDXTag,{name:"h2",components:a,props:{id:"the-xstate-interpreter"}},o.a.createElement(m.MDXTag,{name:"a",components:a,parentName:"h2",props:{href:"#the-xstate-interpreter","aria-hidden":!0,class:"anchor"}}),"The XState interpreter"),o.a.createElement(m.MDXTag,{name:"p",components:a},"Since version 4.0, XState provides an (optional) interpreter that you can use to run your statecharts. The interpreter handles:"),o.a.createElement(m.MDXTag,{name:"ul",components:a},o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"State transitions"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Executing actions (side-effects)"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Delayed events with cancellation"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Activities (ongoing actions)"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Invoking/spawning child statechart services"),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"Support for multiple listeners for state transitions, context changes, events, etc."),o.a.createElement(m.MDXTag,{name:"li",components:a,parentName:"ul"},"And more!")),o.a.createElement("div",{className:"gatsby-highlight","data-language":"js"},o.a.createElement("pre",{className:"language-js"},o.a.createElement("code",{className:"language-js"},o.a.createElement("span",{className:"token keyword"},"import")," ",o.a.createElement("span",{className:"token punctuation"},"{")," Machine ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token keyword"},"from")," ",o.a.createElement("span",{className:"token string"},"'xstate'"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token keyword"},"import")," ",o.a.createElement("span",{className:"token punctuation"},"{")," interpret ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token keyword"},"from")," ",o.a.createElement("span",{className:"token string"},"'xstate/lib/interpreter'"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token keyword"},"const")," machine ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"Machine"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token comment"},"/* machine config */"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Interpret the machine, and add a listener for whenever a transition occurs."),"\n",o.a.createElement("span",{className:"token keyword"},"const")," service ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"interpret"),o.a.createElement("span",{className:"token punctuation"},"("),"machine",o.a.createElement("span",{className:"token punctuation"},")"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"onTransition"),o.a.createElement("span",{className:"token punctuation"},"("),"nextState ",o.a.createElement("span",{className:"token operator"},"=>")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","    ","console",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"log"),o.a.createElement("span",{className:"token punctuation"},"("),"nextState",o.a.createElement("span",{className:"token punctuation"},"."),"value",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Start the service"),"\n","service",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"start"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Send events"),"\n","service",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token string"},"'SOME_EVENT'"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Stop the service when you are no longer using it."),"\n","service",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"stop"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";")))),o.a.createElement(m.MDXTag,{name:"h2",components:a,props:{id:"custom-interpreters"}},o.a.createElement(m.MDXTag,{name:"a",components:a,parentName:"h2",props:{href:"#custom-interpreters","aria-hidden":!0,class:"anchor"}}),"Custom interpreters"),o.a.createElement(m.MDXTag,{name:"p",components:a},"You may use any interpreter (or create your own) to run your state machine/statechart. Here's an example minimal implementation that demonstrates how flexible interpretation can be (despite the amount of boilerplate):"),o.a.createElement("div",{className:"gatsby-highlight","data-language":"js"},o.a.createElement("pre",{className:"language-js"},o.a.createElement("code",{className:"language-js"},o.a.createElement("span",{className:"token keyword"},"const")," machine ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token function"},"Machine"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token comment"},"/* machine config */"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Keep track of the current state, and start"),"\n",o.a.createElement("span",{className:"token comment"},"// with the initial state"),"\n",o.a.createElement("span",{className:"token keyword"},"let")," currentState ",o.a.createElement("span",{className:"token operator"},"=")," machine",o.a.createElement("span",{className:"token punctuation"},"."),"initialState",o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Keep track of the listeners"),"\n",o.a.createElement("span",{className:"token keyword"},"const")," listeners ",o.a.createElement("span",{className:"token operator"},"=")," ",o.a.createElement("span",{className:"token keyword"},"new")," ",o.a.createElement("span",{className:"token class-name"},"Set"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Have a way of sending/dispatching events"),"\n",o.a.createElement("span",{className:"token keyword"},"function")," ",o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),"event",o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","  ",o.a.createElement("span",{className:"token comment"},"// Remember: machine.transition() is a pure function"),"\n","  ","currentState ",o.a.createElement("span",{className:"token operator"},"=")," machine",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"transition"),o.a.createElement("span",{className:"token punctuation"},"("),"currentState",o.a.createElement("span",{className:"token punctuation"},",")," event",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n","  ",o.a.createElement("span",{className:"token comment"},"// Get the side-effect actions to execute"),"\n","  ",o.a.createElement("span",{className:"token keyword"},"const")," ",o.a.createElement("span",{className:"token punctuation"},"{")," actions ",o.a.createElement("span",{className:"token punctuation"},"}")," ",o.a.createElement("span",{className:"token operator"},"=")," currentState",o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n","  ","actions",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"forEach"),o.a.createElement("span",{className:"token punctuation"},"("),"action ",o.a.createElement("span",{className:"token operator"},"=>")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","    ",o.a.createElement("span",{className:"token comment"},"// If the action is executable, execute it"),"\n","    ","action",o.a.createElement("span",{className:"token punctuation"},"."),"exec ",o.a.createElement("span",{className:"token operator"},"&&")," action",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"exec"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","  ",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n","  ",o.a.createElement("span",{className:"token comment"},"// Notify the listeners"),"\n","  ","listeners",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"forEach"),o.a.createElement("span",{className:"token punctuation"},"("),"listener ",o.a.createElement("span",{className:"token operator"},"=>")," ",o.a.createElement("span",{className:"token function"},"listener"),o.a.createElement("span",{className:"token punctuation"},"("),"currentState",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","\n",o.a.createElement("span",{className:"token keyword"},"function")," ",o.a.createElement("span",{className:"token function"},"listen"),o.a.createElement("span",{className:"token punctuation"},"("),"listener",o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","  ","listeners",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"add"),o.a.createElement("span",{className:"token punctuation"},"("),"listener",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","\n",o.a.createElement("span",{className:"token keyword"},"function")," ",o.a.createElement("span",{className:"token function"},"unlisten"),o.a.createElement("span",{className:"token punctuation"},"("),"listener",o.a.createElement("span",{className:"token punctuation"},")")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","  ","listeners",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token keyword"},"delete"),o.a.createElement("span",{className:"token punctuation"},"("),"listener",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token punctuation"},"}"),"\n","\n",o.a.createElement("span",{className:"token comment"},"// Now you can listen and send events to update state"),"\n",o.a.createElement("span",{className:"token function"},"listen"),o.a.createElement("span",{className:"token punctuation"},"("),"state ",o.a.createElement("span",{className:"token operator"},"=>")," ",o.a.createElement("span",{className:"token punctuation"},"{"),"\n","  ","console",o.a.createElement("span",{className:"token punctuation"},"."),o.a.createElement("span",{className:"token function"},"log"),o.a.createElement("span",{className:"token punctuation"},"("),"state",o.a.createElement("span",{className:"token punctuation"},"."),"value",o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n",o.a.createElement("span",{className:"token punctuation"},"}"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";"),"\n","\n",o.a.createElement("span",{className:"token function"},"send"),o.a.createElement("span",{className:"token punctuation"},"("),o.a.createElement("span",{className:"token string"},"'SOME_EVENT'"),o.a.createElement("span",{className:"token punctuation"},")"),o.a.createElement("span",{className:"token punctuation"},";")))))};var r={}}}]);
//# sourceMappingURL=component---src-pages-guides-interpretation-mdx-0231e6df3d888916f218.js.map